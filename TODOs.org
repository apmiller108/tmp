:PROPERTIES:
:CATEGORY: tmp
:END:
* DONE Build claude adapter
  CLOSED: [2024-04-08 Mon 20:57]
* DONE Setup presets
  CLOSED: [2024-04-08 Mon 20:57]
  https://docs.anthropic.com/claude/prompt-library
* DONE Add preset drop down to form [2/2]
  CLOSED: [2024-04-11 Thu 21:12]
  - [X] Add preset drop down
  - [X] Add temperature drop down 0 - 1 increments of 0.1
    Set the temp based on the preset
* DONE Wire up the claude adapter [4/4]
CLOSED: [2024-04-12 Fri 14:43]
  - [X] Add temperature column float to generate_text_requests
  - [X] Rename GenerativeTextPreset to GenerateTextPreset
  - [X] Add optional reference to generate_text_preset
  - [X] Use Claude Client in generate_text_job. Pass in temperature and system message.
* DONE auto set temp when selecting a preset
  CLOSED: [2024-04-13 Sat 09:00]
* DONE Do not delete prompt on sending request [2/2]
CLOSED: [2024-04-18 Thu 14:07]
  - [X] for text
  - [X] for images
* DONE Move generative text placeholder out of input field into header [2/2]
CLOSED: [2024-04-18 Thu 14:07]
  - [X] for text
  - [X] for images
* DONE Insert generated text into a quote block
CLOSED: [2024-04-19 Fri 11:44]
* DONE Show flash message on failure of gen text
CLOSED: [2024-04-19 Fri 14:02]
* DONE Associate a conversation to a Memo [8/8]
CLOSED: [2024-04-26 Fri 13:46]
  Persist dialogue between use the LLM
  conversations
    memo_id
    exchange:jsonb

  1. [X] Create Conversation endpoint with create action POST /memos//:id/conversations
  2. [X] Add index generate text request text_id
  3. [X] On successful generate text response, client makes call to create or update
     conversation. Passes the text_id and memo_id.
  4. [X] If memo has conversation, update it; otherwise create a new conversation.

  5. [X] Add the memo's conversation.id to the generate text form
  6. [X] Send conversation.id when client submits generate text request
  7. [X] Generate image request belongs to a conversation optionally
  8. [X] Include the conversation_id in the generate_text_request params
* DONE Submit previous dialog with each generative text request
CLOSED: [2024-04-26 Fri 16:20]
* DONE Auto save memo after or before text or image generated, but before saving the conversation [3/3]
CLOSED: [2024-05-03 Fri 13:30]
  Creating or updating a conversation requires a persisted memo
  - [X] Add JSON format to MemosController#update/create action OR new autosave
    action? Will need to broadcast the memo card component.
  - [X] Add functions to auto save (update/create) memo to http.js
  - [X] Synchronously create the memo before creating the conversation. I think
    the update could be async.
* DONE Broadcast MemoCardComponent from comp stats job
CLOSED: [2024-05-03 Fri 14:01]
* TODO Fixing lost newline characters in generated text
* TODO Update spec/requests/conversations_spec.rb with index action
* TODO Update spec/requests/generate_text_requests_spec.rb
  include temperature generate_text_preset_id and conversation_id in the params
* TODO Add spec/requests/memos/autosaves_spec.rb
* TODO update ComputeStatsJob spec
* TODO update MemoFormComponent spec
  When conversation exists, the conversation-id data set attr exists
* TODO ConversationForm spec
* TODO GenerativeText::Anthropic::Client spec
* TODO GenerativeText::Anthropic::InvokeModelResponse
* TODO update spec/system/memos/memo_spec.rb
  - Include test for creating new memo with generating text
  - It autosaves
  - It creates a conversation
  - It sets the conversation id on the form
  - It sets the conversation id on the wysiwyg editor
